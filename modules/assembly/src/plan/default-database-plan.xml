<?xml version="1.0" encoding="UTF-8"?>

<connector xmlns="http://geronimo.apache.org/xml/ns/j2ee"
    version="1.5"
    configId="org/apache/geronimo/DefaultDatabase"
    parentId="org/apache/geronimo/Server">

    <dependency>
        <uri>axion/jars/axion-1.0-M3-dev.jar</uri>
    </dependency>

    <!--used by geronimo directly
    <dependency>
        <uri>commons-logging/jars/commons-logging-1.0.3.jar</uri>
    </dependency>-->

    <dependency>
        <uri>commons-collections/jars/commons-collections-2.1.jar</uri>
    </dependency>

    <dependency>
        <uri>commons-primitives/jars/commons-primitives-1.0.jar</uri>
    </dependency>

    <dependency>
        <uri>regexp/jars/regexp-1.3.jar</uri>
    </dependency>

    <resourceadapter>
        <outbound-resourceadapter>
            <connection-definition>
                <connectionfactory-interface>javax.sql.DataSource</connectionfactory-interface>
                <connectiondefinition-instance>
                    <name>DefaultDatasource</name>
                    <config-property-setting name="UserName"></config-property-setting>
                    <config-property-setting name="Password"></config-property-setting>
                    <config-property-setting name="Driver">org.axiondb.jdbc.AxionDriver</config-property-setting>
                    <config-property-setting name="ConnectionURL">jdbc:axiondb:DefaultDatabase</config-property-setting>
                    <config-property-setting name="CommitBeforeAutocommit">true</config-property-setting>
                    <connectionmanager>
                        <local-transaction/>
                        <single-pool>
                            <max-size>10</max-size>
                            <blocking-timeout-milliseconds>5000</blocking-timeout-milliseconds>
                            <match-one/>
                        </single-pool>
                    </connectionmanager>
                    <global-jndi-name>tranql/axion</global-jndi-name>
                    <!--credential-interface>javax.resource.spi.security.PasswordCredential</credential-interface-->
                </connectiondefinition-instance>
            </connection-definition>
        </outbound-resourceadapter>
    </resourceadapter>

    <!--gbean name="geronimo.security:service=RealmBridge,name=TargetRealm" class="org.apache.geronimo.security.bridge.ConfiguredIdentityUserPasswordRealmBridge">
        <attribute name="TargetRealm" type="java.lang.String">TargetRealm</attribute>
        <attribute name="ConfiguredUser" type="java.lang.String">testUser</attribute>
        <attribute name="ConfiguredPassword" type="java.lang.String">testPassword</attribute>
    </gbean-->

    <gbean name="geronimo.server:type=ThreadPooledTimer,name=JDBCTransactionalThreadPooledTimer" class="org.apache.geronimo.timer.jdbc.JDBCStoreThreadPooledTransactionalTimer">
        <attribute name="repeatCount" type="int">5</attribute>
        <reference name="TransactionContextManager">geronimo.server:type=TransactionContextManager</reference>
        <reference name="ManagedConnectionFactoryWrapper">geronimo.server:J2EEServer=geronimo,j2eeType=JCAManagedConnectionFactory,name=DefaultDatasource</reference>
        <reference name="ThreadPool">geronimo.server:type=ThreadPool,name=DefaultThreadPool</reference>
    </gbean>

    <gbean name="geronimo.server:type=ThreadPooledTimer,name=JDBCNonTransactionalThreadPooledTimer" class="org.apache.geronimo.timer.jdbc.JDBCStoreThreadPooledNonTransactionalTimer">
        <reference name="ManagedConnectionFactoryWrapper">geronimo.server:J2EEServer=geronimo,j2eeType=JCAManagedConnectionFactory,name=DefaultDatasource</reference>
        <reference name="ThreadPool">geronimo.server:type=ThreadPool,name=DefaultThreadPool</reference>
    </gbean>

</connector>
